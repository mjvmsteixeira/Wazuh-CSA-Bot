![CSA-Bot](https://github.com/user-attachments/assets/352ca8e3-79d9-4477-af03-f19450e3c4f1)


<img width="770" height="424" alt="Screenshot 2025-09-14 140338" src="https://github.com/user-attachments/assets/2fa6c821-817e-4fde-84f1-860a88a90fff" />


# Wazuh SCA AI Analyst

âš ï¸ Disclaimer

The remediation steps provided by the AI model . The Developer/Auther of this tool are not responsible for any direct or indirect damage resulting from the application of these solutions. Always test configurations in a test environment before deploying them to production.


<div dir="rtl">âš ï¸ Ø¥Ø®Ù„Ø§Ø¡ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©</div>

<div dir="rtl">
Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ù…Ù† Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ , Ù…Ø¤Ù„Ù ÙˆÙ…Ø·ÙˆØ± Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© ØºÙŠØ± Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ø¹Ù† Ø£ÙŠ Ø¶Ø±Ø± Ù…Ø¨Ø§Ø´Ø± Ø£Ùˆ ØºÙŠØ± Ù…Ø¨Ø§Ø´Ø± ÙŠÙ†ØªØ¬ Ø¹Ù† ØªØ·Ø¨ÙŠÙ‚ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ù„ÙˆÙ„. Ù‚Ù… Ø¯Ø§Ø¦Ù…Ø§ Ø¨Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠ Ø¨ÙŠØ¦Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù‚Ø¨Ù„ ØªØ·Ø¨ÙŠÙ‚Ù‡Ø§ ÙÙŠ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬.
</div>




<div align="center">
<strong>
<a href="#-about-the-project">English</a> | <a href="#-Ø¹Ù†-Ø§Ù„Ù…Ø´Ø±ÙˆØ¹">Ø¹Ø±Ø¨ÙŠ</a>
</strong>
</div>
# ğŸ“– About the Project

Wazuh SCA AI Analyst is a powerful and innovative tool designed to help cybersecurity analysts and system administrators understand and remediate Security Configuration Assessment (SCA) scan results within the Wazuh platform.

Instead of reading complex technical reports, this tool utilizes a large language model (LLM) that runs completely offline to analyze these reports. Through a user-friendly interactive menu, it provides a simplified explanation of the problem, detailed remediation steps, and the ability to export these reports as PDF files in both English and Arabic.


# âœ¨ Features

    Interactive and Easy-to-Use Menu: A Text-based User Interface (TUI) makes interacting wit![Uploading Screenshot 2025-09-14 140338.pngâ€¦]()
h the tool simple and direct.

    Intelligent Analysis: Uses a local (Offline) AI model to transform technical data into practical explanations and steps.

    Multi-language Support: Ability to generate reports in Arabic or English.

    Professional Exporting: Option to export final reports as plain text or as formatted PDF files.

    Works Offline: The core of the system (the AI engine) runs entirely on your server without needing to connect to any cloud services, ensuring data privacy and security.

    High Flexibility: Ability to analyze any agent and any check easily through the menu.

<br>
# ğŸ“– Ø¹Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

Wazuh SCA AI Analyst Ù‡ÙŠ Ø£Ø¯Ø§Ø© Ù‚ÙˆÙŠØ© ÙˆÙ…Ø¨ØªÙƒØ±Ø© Ù…ØµÙ…Ù…Ø© Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù…Ø­Ù„Ù„ÙŠ Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ ÙˆÙ…Ø¯ÙŠØ±ÙŠ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø¹Ù„Ù‰ ÙÙ‡Ù… ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ù†ØªØ§Ø¦Ø¬ ÙØ­Øµ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© (SCA) ÙÙŠ Ù…Ù†ØµØ© Wazuh.

Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠØ© Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©ØŒ ØªÙ‚ÙˆÙ… Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ù…ÙˆØ°Ø¬ Ù„ØºÙˆÙŠ ÙƒØ¨ÙŠØ± (LLM) ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ÙƒØ§Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ù„ØªØ­Ù„ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±. Ù…Ù† Ø®Ù„Ø§Ù„ Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ø³Ù‡Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…ØŒ ØªÙ‚Ø¯Ù… Ø§Ù„Ø£Ø¯Ø§Ø© Ø´Ø±Ø­Ù‹Ø§ Ù…Ø¨Ø³Ø·Ù‹Ø§ Ù„Ù„Ù…Ø´ÙƒÙ„Ø©ØŒ ÙˆØ®Ø·ÙˆØ§Øª Ø­Ù„ ØªÙØµÙŠÙ„ÙŠØ©ØŒ Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªØµØ¯ÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø¨ØµÙŠØºØ© PDF Ø¨Ø§Ù„Ù„ØºØªÙŠÙ† Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©.
âœ¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª

    Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ø³Ù‡Ù„Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…: ÙˆØ§Ø¬Ù‡Ø© Ù…Ø³ØªØ®Ø¯Ù… Ù†ØµÙŠØ© (TUI) ØªØ¬Ø¹Ù„ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ø³ÙŠØ·Ù‹Ø§ ÙˆÙ…Ø¨Ø§Ø´Ø±Ù‹Ø§.

    ØªØ­Ù„ÙŠÙ„ Ø°ÙƒÙŠ: ÙŠØ³ØªØ®Ø¯Ù… Ù†Ù…ÙˆØ°Ø¬ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…Ø­Ù„ÙŠ (Offline) Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙ†ÙŠØ© Ø¥Ù„Ù‰ Ø´Ø±Ø­ ÙˆØ®Ø·ÙˆØ§Øª Ø¹Ù…Ù„ÙŠØ©.

    Ø¯Ø¹Ù… Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù„ØºØ§Øª: Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©.

    ØªØµØ¯ÙŠØ± Ø§Ø­ØªØ±Ø§ÙÙŠ: Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ÙƒÙ†Øµ Ø¹Ø§Ø¯ÙŠ Ø£Ùˆ ÙƒÙ…Ù„Ù PDF Ù…Ù†Ø³Ù‚.

    ÙŠØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª: Ù‚Ù„Ø¨ Ø§Ù„Ù†Ø¸Ø§Ù… (Ù…Ø­Ø±Ùƒ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ) ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ÙƒØ§Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ±ÙØ± Ø¯ÙˆÙ† Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ø£ÙŠ Ø®Ø¯Ù…Ø© Ø³Ø­Ø§Ø¨ÙŠØ©ØŒ Ù…Ù…Ø§ ÙŠØ¶Ù…Ù† Ø®ØµÙˆØµÙŠØ© ÙˆØ£Ù…Ø§Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.

    Ù…Ø±ÙˆÙ†Ø© Ø¹Ø§Ù„ÙŠØ©: Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªØ­Ù„ÙŠÙ„ Ø£ÙŠ Ø¹Ù…ÙŠÙ„ (Agent) ÙˆØ£ÙŠ ÙØ­Øµ (Check) Ø¨Ø³Ù‡ÙˆÙ„Ø© Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.

ğŸ› ï¸ How it Works / ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ØŸ

The system is based on a simple architecture of several scripts working together:

    ai_menu.py (Main Menu): The primary user interface. It displays the banner, handles user choices, and calls other scripts with the correct parameters.

    CSA_generator.py (Report Generator): The client that connects to the Wazuh API to fetch scan data, sends it to the AI engine, and then prints or saves the report as a PDF.

    ai_engine.py (AI Engine): The server that runs in the background. It loads the language model into memory and waits for analysis requests to process and respond to.

    Helper Scripts: Such as debug_sca.py and list_sca_checks.py to help with diagnostics and finding check IDs.

ğŸ“‹ Requirements / Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª

    A running Wazuh server.

    Python 3.8 or newer.

    The following libraries: flask, llama-cpp-python, requests, fpdf2, arabic_reshaper, python-bidi.

    A large language model in GGUF format (the project was tested with Llama 3 8B Instruct).

    A font that supports Arabic installed on the server (like ttf-dejavu) to correctly render Arabic reports in PDF files.

ğŸš€ Installation and Usage / Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ«Ø¨ÙŠØª ÙˆØ§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
1. Setup the Project / ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

# Clone the repository (or create a folder and place all scripts inside)
git clone https://github.com/Hazematiya2023/Wazuh-CSA-Bot.git


cd Wazuh-CSA-Bot

# Create a virtual environment
python3 -m venv ai_env

# Activate the environment
source ai_env/bin/activate

# Install all required libraries
pip install flask llama-cpp-python requests fpdf2 arabic_reshaper python-bidi


2. Download the AI Model / ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ

Download a language model in GGUF format from sources like Hugging Face. We recommend Llama-3-8B-Instruct-Q4_K_M.gguf. You can download it directly using the following command:

wget "[https://huggingface.co/QuantFactory/Meta-Llama-3-8B-Instruct-GGUF/resolve/main/Meta-Llama-3-8B-Instruct.Q4_K_M.gguf](https://huggingface.co/QuantFactory/Meta-Llama-3-8B-Instruct-GGUF/resolve/main/Meta-Llama-3-8B-Instruct.Q4_K_M.gguf)" -O llama-3-8b-instruct.Q4_K_M.gguf



Place the downloaded model file in your project directory. Important: Open the ai_engine.py file and update the MODEL_PATH variable to point to the correct name of your model file.

# Example inside ai_engine.py
MODEL_PATH = "Meta-Llama-3-8B-Instruct.Q4_K_S.gguf" 


3. Configure the Settings / Ø¶Ø¨Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª

You need to update your Wazuh API password and the target SCA policy in the scripts.

A. Update API Password:
Open all helper scripts (CSA_generator.py, debug_sca.py, list_sca_checks.py) and update the WAZUH_PASSWORD variable.

# Section to modify in the scripts
# --- SETTINGS ---
WAZUH_API_URL = "[https://127.0.0.1:55000](https://127.0.0.1:55000)"
WAZUH_USER = "wazuh"
WAZUH_PASSWORD = "YOUR_API_PASSWORD" # <--- Update your password here
# ...


B. Update Policy ID:
The POLICY_ID variable determines which set of compliance checks to analyze. Open get_sca_report.py and list_sca_checks.py and change the POLICY_ID to match the operating system of the agent you are analyzing.

# Section to modify in the scripts
# --- SETTINGS ---
# ...
POLICY_ID = "cis_win2016" # <--- Change this value
# ...


Here are some common examples for POLICY_ID:

    cis_win2016 for Windows Server 2016

    cis_win2019 for Windows Server 2019

    cis_ubuntu20-04 for Ubuntu 20.04

    cis_rhel8 for Red Hat 8

4. Run the Tool / ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø©

You will need two open terminal windows.

In Terminal 1 (Start the Server):

# Activate the environment
source ai_env/bin/activate

# Run the AI engine and leave it running
python3 ai_engine.py


In Terminal 2 (Start the Main Menu):

# Activate the environment
source ai_env/bin/activate

# Run the main menu
python3 ai_menu.py




Now you can follow the on-screen instructions in the interactive menu to use the tool.
# Example : for check Failed ID 16001
<img width="908" height="980" alt="Screenshot 2025-09-07 122323" src="https://github.com/user-attachments/assets/6f3c7985-722c-4b95-92ec-1057ee4a371a" />

# Example : for check Failed ID 16004
<img width="892" height="889" alt="Screenshot 2025-09-08 143852" src="https://github.com/user-attachments/assets/5b13be6b-5fd3-4a11-a27d-d76671681480" />


also you can generate PDF file and it will be stored under the same folder , and you can transfer it using any sftp application to your PC.

# This is example for PDF report generate by this tool:

<img width="756" height="554" alt="Screenshot 2025-09-11 104110" src="https://github.com/user-attachments/assets/624fd901-c2f1-4de0-adfe-8288b9cd0d45" />




<img width="968" height="533" alt="Screenshot 2025-09-14 003020" src="https://github.com/user-attachments/assets/e84339e1-a7c1-4f44-a797-b59248f34f79" />



<img width="1592" height="1016" alt="Screenshot 2025-09-14 005704" src="https://github.com/user-attachments/assets/1da91c12-ff19-479c-8720-fefd66c52ea5" />



âœï¸ Author / Ø§Ù„Ù…Ø¤Ù„Ù

This tool was developed by Hazem Mohamed - Wazuh Ambassador in Egypt.

    Wazuh Ambassador Profile
    https://wazuh.com/ambassadors/hazem-mohamed/ 
    LinkedIn:
    https://www.linkedin.com/in/hazem-mohamed-03742957/

ğŸ“œ License / Ø§Ù„ØªØ±Ø®ÙŠØµ

This project is licensed under the MIT License. See the LICENSE file for more details.
