# Wazuh API Configuration
WAZUH_API_URL=https://127.0.0.1:55000
WAZUH_USER=wazuh
WAZUH_PASSWORD=your_wazuh_password_here
WAZUH_VERIFY_SSL=false

# AI Configuration Mode
# Options: "local", "external", "mixed"
# - local: Only vLLM (internal GPU-based model) - vLLM container will start
# - external: Only OpenAI/Cloud APIs - vLLM container will NOT start
# - mixed: Both available, user can choose - vLLM container will start
AI_MODE=mixed

# Local LLM (vLLM Docker) - Only used if AI_MODE is "local" or "mixed"
VLLM_API_URL=http://vllm:8000/v1
VLLM_MODEL=meta-llama/Meta-Llama-3-8B-Instruct

# GPU Memory Configuration (adjust based on available GPU memory)
# Default is 0.9 (90% of GPU memory). Lower this if you get memory errors
# For 4GB GPU with limited free memory, use 0.7 (70%) or lower
GPU_MEMORY_UTILIZATION=0.7

# Auto-download AI model (local LLM only)
# Set to "true" to automatically download the model on first run
# Set to "false" if you have already downloaded the model manually to ./models/
AUTO_DOWNLOAD_MODEL=true

# Hugging Face Token (required for gated models like Llama)
# Get your token from: https://huggingface.co/settings/tokens
HF_TOKEN=your_hugging_face_token_here

# External LLM (OpenAI) - Only used if AI_MODE is "external" or "mixed"
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-4
OPENAI_BASE_URL=https://api.openai.com/v1

# Application Settings
APP_ENV=development
APP_PORT=8000
LOG_LEVEL=INFO
SECRET_KEY=your_secret_key_here

# Report Export Settings
# Format for batch analysis reports: "pdf" or "markdown"
EXPORT_FORMAT=pdf

# Database (optional - for history)
DATABASE_URL=sqlite:///./sca_history.db

# Redis Cache (optional) - Uncomment to enable caching
# Set ENABLE_REDIS_CACHE=true and start with: docker-compose --profile cache up
ENABLE_REDIS_CACHE=false
REDIS_URL=redis://redis:6379/0

# Cache TTL (Time To Live) in seconds - Customize per resource type
REDIS_TTL_DEFAULT=3600        # Default TTL for unconfigured caches (1 hour)
REDIS_TTL_AGENTS=300          # Agents list cache (5 minutes)
REDIS_TTL_POLICIES=600        # SCA policies cache (10 minutes)
REDIS_TTL_CHECKS=300          # SCA checks cache (5 minutes)

# Analysis History & Cache
# Enable caching of AI analysis results in database
ENABLE_ANALYSIS_CACHE=true
# How long to cache analysis results (in hours)
ANALYSIS_CACHE_TTL_HOURS=24
